server:
	# Interfaces and access
	interface:                      0.0.0.0
	interface:                      ::0
	do-ip4:                         yes
	do-ip6:                         yes
	do-tcp:                         yes
	do-udp:                         yes

	access-control:                 10.20.0.0/28          allow
	access-control:                 192.168.5.0/28        allow
	access-control:                 192.168.15.0/28       allow
	access-control:                 192.168.20.0/28       allow
	access-control:                 fe80::/64 allow

	access-control:                 0.0.0.0/0             refuse
	access-control:                 ::/0                  refuse

	num-threads:                    4
	outgoing-num-tcp:               20
	incoming-num-tcp:               20
	outgoing-range:                 4096

	# Cache optimizations (larger for reduced recursion load)
	msg-cache-size:                 100m
	msg-cache-slabs:                4        # Power of 2 near num-threads
	rrset-cache-size:               200m
	rrset-cache-slabs:              4
	infra-cache-slabs:              4
	key-cache-size:                 20m
	key-cache-slabs:                4
	neg-cache-size:                 10m
	num-queries-per-thread:         4096

	# Hardening and security
	harden-glue:                    yes
	harden-dnssec-stripped:         yes
	harden-below-nxdomain:          yes
	qname-minimisation:             yes
	aggressive-nsec:                yes
	val-clean-additional:           yes
	use-caps-for-id:                no       # Optional: enable for extra anti-spoofing
	hide-identity:                  yes
	hide-version:                   yes

	# Resilience and stale data serving (per RFC 8767)
	serve-expired:                  yes
	serve-expired-ttl:              86400
	serve-expired-reply-ttl:        30
	serve-expired-client-timeout:   1800

	# Efficiency tweaks
	prefetch:                       yes
	minimal-responses:              yes
	rrset-roundrobin:               yes
	cache-max-ttl:                  86400
	cache-min-ttl:                  300      # Avoid very short TTLs if desired
	infra-host-ttl:                 900
	infra-cache-numhosts:           10000

	# Rate limiting to prevent abuse
	ratelimit:                      2000
	ratelimit-size:                 4m
	ratelimit-slabs:                4
	ip-ratelimit:                   100
	ip-ratelimit-size:              1m
	ip-ratelimit-slabs:             4

	# Recursion limits to prevent loops/excessive load
	max-sent-count:                 32
	max-query-restarts:             11

	# Logging (adjust verbosity as needed)
	verbosity:                      1
	log-queries:                    yes      # Enable for debugging
	log-replies:                    yes
